from projectq import MainEngine
from projectq.backends import ResourceCounter, _resource, ClassicalSimulator, CommandPrinter
from projectq.meta import Uncompute, Compute
from projectq.ops import H, Tdag, CNOT, T, X, Toffoli, Measure, All
from projectq.setups import linear

def Mixcolumn(eng, x):
    CNOT | (x[23], x[31])
    CNOT | (x[8], x[24])
    CNOT | (x[29], x[21])
    CNOT | (x[18], x[26])
    CNOT | (x[17], x[1])
    CNOT | (x[3], x[11])
    CNOT | (x[2], x[10])
    CNOT | (x[20], x[28])
    CNOT | (x[22], x[14])
    CNOT | (x[19], x[27])
    CNOT | (x[5], x[13])
    CNOT | (x[7], x[23])
    CNOT | (x[1], x[25])
    CNOT | (x[6], x[22])
    CNOT | (x[4], x[20])
    CNOT | (x[9], x[17])
    CNOT | (x[13], x[29])
    CNOT | (x[28], x[12])
    CNOT | (x[15], x[7])
    CNOT | (x[23], x[8])
    CNOT | (x[25], x[9])
    CNOT | (x[12], x[4])
    CNOT | (x[13], x[6])
    CNOT | (x[17], x[2])
    CNOT | (x[28], x[5])
    CNOT | (x[8], x[25])
    CNOT | (x[7], x[16])
    CNOT | (x[11], x[12])
    CNOT | (x[13], x[30])
    CNOT | (x[14], x[15])
    CNOT | (x[28], x[29])
    CNOT | (x[23], x[17])
    CNOT | (x[0], x[8])
    CNOT | (x[27], x[11])
    CNOT | (x[21], x[13])
    CNOT | (x[14], x[30])
    CNOT | (x[17], x[18])
    CNOT | (x[23], x[28])
    CNOT | (x[31], x[0])
    CNOT | (x[5], x[14])
    CNOT | (x[2], x[27])
    CNOT | (x[20], x[21])
    CNOT | (x[19], x[28])
    CNOT | (x[24], x[17])
    CNOT | (x[24], x[0])
    CNOT | (x[29], x[14])
    CNOT | (x[18], x[27])
    CNOT | (x[12], x[20])
    CNOT | (x[26], x[2])
    CNOT | (x[3], x[28])
    CNOT | (x[4], x[5])
    CNOT | (x[23], x[18])
    CNOT | (x[11], x[20])
    CNOT | (x[26], x[19])
    CNOT | (x[10], x[3])
    CNOT | (x[7], x[12])
    CNOT | (x[16], x[24])
    CNOT | (x[30], x[23])
    CNOT | (x[1], x[26])
    CNOT | (x[10], x[18])
    CNOT | (x[7], x[3])
    CNOT | (x[31], x[20])
    CNOT | (x[12], x[4])
    CNOT | (x[15], x[23])
    CNOT | (x[9], x[18])
    CNOT | (x[1], x[10])
    CNOT | (x[31], x[7])
    CNOT | (x[28], x[4])
    CNOT | (x[6], x[23])
    CNOT | (x[25], x[1])
    CNOT | (x[31], x[19])
    CNOT | (x[7], x[17])
    CNOT | (x[2], x[10])
    CNOT | (x[20], x[28])
    CNOT | (x[18], x[26])
    CNOT | (x[22], x[31])
    CNOT | (x[16], x[25])
    CNOT | (x[14], x[6])
    CNOT | (x[11], x[19])
    CNOT | (x[0], x[1])
    CNOT | (x[13], x[22])
    CNOT | (x[7], x[16])
    CNOT | (x[3], x[11])
    CNOT | (x[1], x[9])
    CNOT | (x[30], x[22])
    CNOT | (x[5], x[13])
    CNOT | (x[15], x[7])
    CNOT | (x[8], x[16])
    CNOT | (x[27], x[3])
    CNOT | (x[17], x[1])
    CNOT | (x[22], x[14])
    CNOT | (x[21], x[5])
    CNOT | (x[31], x[15])
    CNOT | (x[19], x[27])
    CNOT | (x[24], x[8])
    CNOT | (x[25], x[17])
    CNOT | (x[23], x[31])
    CNOT | (x[29], x[21])

if __name__ == "__main__":
    circuit_backend = _resource.ResourceCounter()
    eng = MainEngine(backend=circuit_backend)
    x = eng.allocate_qureg(32)

    Mixcolumn(eng, x)

    # All(Measure) | u, t, m, l, s

    eng.flush()

    print(circuit_backend)
    print("depth_of_dag: {}".format(circuit_backend.depth_of_dag))